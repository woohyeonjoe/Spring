# 데이터 접근 기술 - 스프링 데이터 JPA

## 스프링 데이터 JPA 소개1 - 등장 이유

## 스프링 데이터 JPA 소개2 - 기능

- 인터페이스만 구현하면 이것을 기반으로 구현클래스를 생성해준다
- 메서드 이름으로 쿼리 생성
- JPQL, 네이티브 쿼리 지원 `@Query`

**장점**

- 코딩량
- 도메인 클래스를 중요하게 다룸
- 비지니스 로직 이해 쉬움
- 더 많은 테스트 케이스 작성 가능

## 스프링 데이터 JPA 주요 기능

스프링 데이터 JPA는 JPA를 편리하게 사용할 수 있도록 도와주는 라이브러리이다.
수많은 편리한 기능을 제공하지만 가장 대표적인 기능은 다음과 같다.

- 공통 인터페이스 기능
- 쿼리 메서드 기능 (인터페이스에 메서드만 적어두면, 메서드 이름으로 쿼리를 자동으로 만들어줌)
- JPQL, 네이티브 쿼리 지원 `@Query`

## 스프링 데이터 JPA 적용1

**SprintDataJpaItemRepository 인터페이스 생성 (JpaRepository 상속)**

- 기본적인 CRUD기능은 제공
- 이름으로 검색하거나, 가격으로 검색하는 기능은 공통으로 제공할 수 있는 기능이 아니다. 따라서 쿼리 메서드 기능을 사용하거나 @Query 를 사용해서 직접 쿼리를 실행하면 된다.
    - 스프링 데이터 JPA 기술만으론 동적 쿼리를 작성하는데 어려움이 있다. 우선 데이터 조건에 맞는 4가지 쿼리를 모두 만들었다.
    

## 스프링 데이터 JPA 적용2

findAll() 테스트 중

`org.springframework.dao.InvalidDataAccessApiUsageException: Parameter value [\] did not match expected type [java.lang.String (n/a)];` 에러 발생

**이는 하이버네이트 최신 버전 버그로 버전을 낮춰야 함.**

**build.gradle**에 `ext["hibernate.version"] = "5.6.5.Final"` 추가

**예외 변환**
스프링 데이터 JPA도 스프링 예외 추상화를 지원한다. 스프링 데이터 JPA가 만들어주는 프록시에서 이미 예외 변환을 처리하기 때문에, @Repository와 관계없이 예외가 변환된다.
